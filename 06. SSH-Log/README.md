# SSHLog Documentation

SSHLog is an eBPF-based tool designed for passive monitoring of SSH activity on OpenSSH servers. It tracks various SSH events such as connections, commands executed, and output generated, providing detailed logs for analysis and security monitoring.

## 1. Introduction

### Overview

SSHLog is an advanced monitoring tool that utilizes eBPF technology to capture and log SSH activity on Linux-based systems running OpenSSH servers. It offers real-time visibility into SSH sessions, enabling administrators to monitor user activities and detect suspicious behavior.

### Technology (eBPF)

eBPF (Extended Berkeley Packet Filter) allows SSHLog to operate securely within the Linux kernel. It provides a sandboxed environment for running programs that monitor system events like network connections (`connect`), process executions (`execve`), and file operations (`read`, `write`).

## 2. Features

### Monitored Events

SSHLog monitors the following SSH events:
- SSH connections
- Executed SSH commands
- Output generated by SSH commands

These events are tracked using kernel-level hooks and syscalls, ensuring comprehensive monitoring without relying on external agents.

### Logging and Reporting

- Logs SSH events to a configurable log file.
- Supports integration with syslog for centralized logging.
- Integration with statsd for metrics collection and monitoring.

### Integration Capabilities

- Sends notifications to Slack or email for suspicious or malicious activity.
- Plugin-based architecture allows extending functionality as per organizational needs.
- Can execute arbitrary commands/scripts based on predefined triggers (e.g., detecting specific commands like `nmap`).

### Customization and Extensibility

SSHLog's plugin system enables customization and extension of monitoring capabilities. Administrators can add new event handlers, modify existing plugins, or develop entirely new functionality to tailor SSHLog to specific requirements.

## 3. Installation

### Requirements

- Linux kernel with eBPF support (minimum version required).
- OpenSSH server installed and configured.
- Python (for integration scripts and plugins).

### Installation Steps

1. **Clone the SSHLog repository:**
   ```bash
   git clone https://github.com/sshlog/agent.git
   ```

2. **Install dependencies and build:**
   ```bash
   cd agent
   make install
   ```

3. **Configure SSHLog as per your environment:**
   - Edit configuration files (`sshlog.conf`, `plugins.conf`) to set up logging destinations, notification settings, and any custom triggers.

4. **Start SSHLog:**
   ```bash
   sudo ./sshlog-agent start
   ```

## 4. Configuration

### Basic Configuration

- **`sshlog.conf`:** Main configuration file to specify logging paths, notification settings, and integration options.
- **`plugins.conf`:** Configure plugins for additional functionality and customization.

### Advanced Configuration Options

- Customize event filtering and thresholds.
- Define specific actions for triggered events (e.g., alerting, script execution).

### Integration with Other Tools

- Integrate with existing monitoring systems (e.g., Prometheus, Grafana) via statsd metrics.
- Forward logs to centralized logging systems like syslog-ng or ELK stack.

## 5. Usage

### Viewing Logs

- Access logs directly from configured log files (`sshlog.log` by default).
- Use command-line tools or custom scripts for log parsing and analysis.

### Analyzing SSH Activity

- Identify patterns in user behavior.
- Detect anomalies or unauthorized access attempts.

### Setting Up Notifications

- Configure Slack or email notifications for critical events.
- Define thresholds and triggers for automated alerts.

## 6. Contributing

### Development Setup

- Fork the SSHLog repository and clone locally.
- Set up a development environment with necessary dependencies.
- Follow coding standards and contribute to new features or bug fixes.

### Contributing Guidelines

- Submit pull requests with detailed descriptions of changes.
- Participate in discussions on feature requests or improvements.

## 7. Troubleshooting

### Common Issues

- Kernel compatibility and eBPF support.
- Permission issues with log files or plugin execution.
- Network configuration for remote logging or notifications.

### FAQs

- Address frequently asked questions related to installation, configuration, and usage.

## 8. Support

### Community Support

- Join the SSHLog community forums or mailing lists for support and discussions.
- Share experiences and best practices with other users.

### Reporting Issues

- Use GitHub Issues to report bugs or request new features.
- Provide detailed information about the issue and steps to reproduce it.


This documentation provides a comprehensive guide to understanding, installing, configuring, and using SSHLog for monitoring SSH activity using eBPF technology. Users and administrators can refer to this document for detailed instructions on setup, customization, troubleshooting, and community support.